# Discrete Molecular Dynamics Data Analysis Toolkit
## Introduction
This GitHub repository contains utility programs for the analysis of simulation data generated by Discrete Molecular Dynamics (DMD, available at [Molecules in Action, LLC](https://www.moleculesinaction.com/pdmd.html)).
DMD is a molecular dynamics algorithms with significantly improved computational efficiency and proven accuracy in wide applications. 
The utility programs in this repository are designed to analyze large simulation datasets generated in DMD simulations. Notably, this toolkit provides easy-to-use tools for a comprehensive investigation of protein aggregate properties.

## Dependencies
* Python, version 3.7 or later is recommended. The needed libraries:
  * Matplotlib (https://matplotlib.org)
  * Numpy (https://numpy.org)
* Awk (https://github.com/onetrueawk/awk)

## Secondary structure contents
*ssCont.awk* can rapidly calculate the contents of the average secondary structures of the entire protein system in a DMD trajectory.
This script takes the standard DSSP output from DMD as the input file.
Usage:
```bash
awk -f ssCont.awk in_dssp.example > out_sscont.dat
```
The columns from left to right contains the contents of the secondary structure types, respectively:
* …ë-helix; isolated beta bridge; Œ≤-sheet; 3<sub>10</sub> helix; ùõë-helix; Œ≤-turn; bend; random coil

If you need more detailed information of a specific peptide chain, *ssResCont.py* will calculate the secondary structure propensity of each residue.

Usage:
```python
python ssResCont.py -i in_dssp.example -o out_ssrescont.dat
```
Similarly, the columns from left to right contains the contents of the secondary structure types as described above. Rows from top to bottom corresponds to the amino acid residues in the system as ordered in the starting PDB structure of the simulation.

<!---
## Fibrillar aggregate morphology analysis
Briefly, we can differentiated protein aggregates using their respective morphologies, i.e. number of layers and Œ≤-sheet sizes. The two types of fibrillar aggregates are: 
* Amyloid fibrils, which has a small number of Œ≤-sheet layers (typically 2). [Example](https://www.science.org/doi/10.1126/science.aao2825#F1)
* Nanocrystals, which has a large number of layers (typically more than 2). [Example](https://www.science.org/doi/10.1126/science.aal5005#F2)

In a given molecular system, the total number of peptide chains is constant. Therefore, a nanocrystal conformation will have more layers but small-sized Œ≤-sheets, while a fibril will have fewer layers but large-sized Œ≤-sheets.

*bsh-layers-BC-cutoff.py* can calculate the 
--->

## Protein structure visualization
For structure visualization, [PyMOL](https://www.pymol.org/) is required.
### Coloring
The following tools generate an easy-to-read heat map with custom parameter, where the value of the parameter is mapped onto the protein surface. Each residue is colored according to the parameter value from maximum (red) to minimum (blue): 
<img src="https://github.com/GANGTONGH/Discrete-Molecular-Dynamics-Data-Analysis-Toolkit/blob/224960143076c3c6232b4c74bf5c56838489fc69/Protein%20structure%20coloring/colorbar.png" width="200">.

In this example, we will map the affinity with a small molecule onto the BRICHOS protein structure. 
The following inputs are required:
* *brichos_template.pdb*: the protein structure to be colored
* *contact_prob_per_residue.dat*: the corredponding value of the parameter on each residue, arranged into a single column.

Usage:
```bash
./color.sh brichos_template.pdb contact_prob_per_residue.dat graph.pdb
```
This step generates the colored structure, *graph.pdb*.
Then, load *graph.pdb* into PyMOL. To show the color, run the following command in the PyMOL console:
```python
spectrum b, rainbow, minimum=0, maximum=1
```
The parts of Bri2 BRICHOS with a higher affinity is closer to red (warmer), the parts with lower affinity is closer to blue (colder).

<img src="https://github.com/GANGTONGH/Discrete-Molecular-Dynamics-Data-Analysis-Toolkit/blob/58b7ffac3cca0d53da34547cb60dafa194e09251/Protein%20structure%20coloring/colored_protein.png" width="300">



<!--
## Data visualization

## 2-dimensional PMF visualization
--->

## *(Under construction)*
